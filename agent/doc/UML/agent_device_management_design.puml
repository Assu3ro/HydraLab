@startuml
'https://plantuml.com/class-diagram
enum DevicePairRule{
    SINGLE_PHONE(),
    SINGLE_PC,
    PC_TO_PHONE,
    PHONE_TO_PHONE

    abstract List<DeviceDefine> getDeviceDefine();
}
class AgentManagementService {
    File testBaseDir
    File deviceLogBaseDir
    Map<String,TestDevice> testDevices
    getTestDeviceManager(TestDevice.type)
}
class TestDevice{
    String type
    String serialNumber
    String status
    List<Process> processList
}
abstract class TestDeviceManager{
    AgentManagementService agentManagementService;
    DeviceListener deviceListener;
}
class AndroidTestDeviceManager
class IOSTestDeviceManager
class WindowsTestDeviceManager

interface TestDriver

AndroidTestDeviceManager --|> TestDeviceManager
IOSTestDeviceManager --|> TestDeviceManager
WindowsTestDeviceManager --|> TestDeviceManager

AgentManagementService *--> AndroidTestDeviceManager
AgentManagementService *--> IOSTestDeviceManager
AgentManagementService *--> WindowsTestDeviceManager

TestDeviceManager --> TestDriver

ADBDriver -u-|> TestDriver
AppiumDriver -u-|> TestDriver

class TestRunner{
    static final DevicePairRule devicePairRule;
    Map<String,TestDevice> usedDevices;
    runTest(Map<String,TestDevice> usedDevices, ITestRun testRun)
}

TestRunner -r-> TestDeviceManager
@enduml